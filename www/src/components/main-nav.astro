---
import fs from 'node:fs';
import { DiscordLogo, GitHubLogo } from '@terrazzo/icons';
import { ButtonLink } from '@terrazzo/tiles';
import Terrazzo from './terrazzo.astro';

const pkgInfo = JSON.parse(fs.readFileSync(new URL('../../../packages/cli/package.json', import.meta.url), 'utf8'));
const { version } = pkgInfo;
---

<nav class="nav" aria-label="Main">
  <ul class="nav-list">
    <li class="nav-item">
      <a class="logo-link" href="/"><Terrazzo size="1.25rem" /></a>
    </li>
    <li class="nav-item"><a href="/docs/cli">Docs</a></li>
    <li class="nav-item nav-item--sub" style="margin-bottom:-1px">
      <ButtonLink href="/docs/cli" variant="lime">Get Started</ButtonLink>
    </li>
    <li class="nav-item nav-item--sub">
      <a
        class="nav-link"
        href="https://github.com/terrazzoapp/terrazzo/releases"
        ><code class="version">v{version}</code></a
      >
    </li>
    <li class="nav-item nav-item--sub nav-item--secondary">
      <a
        class="icon-link"
        href="https://github.com/terrazzoapp/terrazzo"
        target="_blank"
        aria-label="Terrazzo on GitHub"><GitHubLogo /></a
      >
    </li>
    <li class="nav-item nav-item--sub nav-item--secondary">
      <a
        class="icon-link"
        href="https://discord.gg/cju3dXyHNd"
        target="_blank"
        aria-label="Join Terrazzo on Discord"><DiscordLogo /></a
      >
    </li>
  </ul>

  <style>
    .nav {
      --nav-height: var(--grid-size);

      background: var(--tz-color-bg-1);
      border-bottom: var(--tz-border-2);
      color: var(--tz-color-text-1);
      height: var(--height);

      a {
        align-items: center;
        display: flex;
        justify-content: center;
        text-decoration: none;
      }
    }

    .nav-list {
      align-items: center;
      display: flex;
      height: var(--nav-height);
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .nav-item {
      justify-content: center;
      display: flex;
      height: 100%;
      flex-direction: column;
    }

    .nav-item a {
      height: 100%;
      padding-inline: 0.5rem;
    }

    .nav-item--secondary {
      display: none;

      @media (width >= 600px) {
        display: flex;
      }
    }

    .nav-item .tz-button {
      height: var(--grid-size);
      width: calc(2.5 * var(--grid-size));
    }

    .nav-items code {
      color: var(--tz-text-3);
    }

    .version {
      display: block;
      text-decoration: none;
      text-align: center;
      padding-inline: 0.25rem;
      white-space: nowrap;
    }

    .nav a:has(.version):hover {
      background: var(--tz-color-bg-selected);
      color: var(--tz-color-text-selected);
    }

    .nav-item:not(.nav-item--sub) + .nav-item--sub {
      margin-left: auto;
    }

    .icon-link {
      padding-inline: 0.25rem;
      text-align: center;
      width: var(--grid-size);

      &:hover {
        background: var(--tz-color-bg-selected);
        color: var(--tz-color-text-selected);
      }

      svg {
        height: 1.25rem;
        min-height: 1.25rem;
        min-width: 1.25rem;
        width: 1.25rem;
      }
    }

    .nav-item:first-of-type a {
      padding-inline-start: 1.5rem;
    }

    .logo-link {
      align-items: center;
      display: flex;
    }
  </style>
</nav>
